<html>
    <head>
        <title>Hampaanpesuaikalaskuri</title>
        <!-- Bootstrap -->
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../font-awesome/css/font-awesome.min.css" rel="stylesheet" >
        <link href="../css/jsomerstone.css" rel="stylesheet">
        <link href="../css/smiley.css" rel="stylesheet">
        <meta charset="utf-8">
        <link rel="shortcut icon" type="image/x-icon" href="../img/favicon.ico">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
        <!-- NAVBAR -->
        <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" id="jsomerstone" href="#">Hampaanpesuaikalaskuri</a>
                </div>
            </div>
        </div><!-- /NAVBAR -->

        <div class="container" style="margin-top: 90px;">
            <div class="row">
                <div class="col-xs-12 col-sm-6 col-sm-offset-3">
                    <div class="smileyface">
                        <p class="eyes lefteye"></p>
                        <p class="eyes righteye"></p>
                        <div class="smile">
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="progress">
                    <div id="pbar" class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="0" style="width: 0%;">
                        <span class="sr-only">60% Complete</span>
                    </div>
                </div>
            </div>
            <div class="row">
                <button class="col-xs-12 col-sm-4 col-sm-offset-3 btn btn-lg btn-primary paused" id="start-btn">
                    <i class="fa fa-3x fa-play" id="status"></i>
                </button>
                <button class="col-xs-12 col-sm-4 col-sm-offset-3 btn btn-lg btn-warning hidden" id="reset-btn">
                    <i class="fa fa-3x fa-refresh"></i>
                </button>
            </div>
        </div>

        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="../js/jquery-2.1.1.min.js"></script>
        <!-- Include all compiled plugins (below), or include individual files as needed -->
        <script src="../js/bootstrap.min.js"></script>
        <script>
            var totalTime = 120, //time in seconds
                timeRemaining = totalTime,
                intervalHandle = false;

            $('#start-btn').click(
                function()
                {
                    $('#status').toggleClass('fa-play').toggleClass('fa-pause');
                    if ( ! intervalHandle)
                    {
                        start();
                    } else {
                        pause();
                    }
                }
            );

            $('#reset-btn').click(reset);
            function start()
            {
                intervalHandle = setInterval(tick, 1000);
            }
            function pause()
            {
                clearInterval(intervalHandle);
                intervalHandle = false;
            }

            function reset()
            {
                location.reload();
            }

            function tick()
            {
                var remaining = timeRemaining/totalTime,
                    percent = 100 - Math.floor(remaining*100);

                $('div.smile').height(70*(1-remaining));
                $('#pbar').width(percent + '%').attr('aria-valuenow', percent);
                if (percent > 66)
                {
                    $('#pbar').removeClass('progress-bar-warning')
                            .addClass('progress-bar-success')
                } else if (percent > 33)
                {
                    $('#pbar').removeClass('progress-bar-danger')
                            .addClass('progress-bar-warning')
                }

                if (--timeRemaining == 0)
                {
                    done();
                }
            }

            function done()
            {
                clearInterval(intervalHandle);
                intervalHandle = false;
                $('#status').toggleClass('fa-play').toggleClass('fa-pause');
                $('body').toggleClass('done');
                $('#start-btn').addClass('hidden');
                $('#reset-btn').removeClass('hidden');
            }
        </script>
    </body>
</html>
